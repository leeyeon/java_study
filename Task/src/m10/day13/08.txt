1번

SELECT
dep.department_name 부서명, TO_CHAR(TO_DATE(emp.hire_date, 'YY/MM/DD'), 'MM') 입사월, count(*) 직원수
FROM employees emp, departments dep
WHERE emp.department_id = dep.department_id
HAVING count(*) >= 5
GROUP BY dep.department_name, TO_CHAR(TO_DATE(emp.hire_date, 'YY/MM/DD'), 'MM')
ORDER BY dep.department_name;


2번

SELECT
NVL(con.country_name, '<부서없음>'), NVL(loc.city, '<부서없음>'), count(*) 직원수
FROM employees emp, departments dep, locations loc, countries con
WHERE emp.department_id = dep.department_id(+)
      AND dep.location_id = loc.location_id(+)
      AND loc.country_id = con.country_id(+)
GROUP BY con.country_name, loc.city
ORDER BY con.country_name NULLS LAST;


3번

SELECT
emp.employee_id 직원아이디, emp.first_name 이름, depts.max 급여, depts.avg 부서평균
FROM employees emp,
( SELECT
  dep.department_id, MAX(emp.salary) max ,TRUNC(AVG(emp.salary), 2) AS avg
  FROM employees emp, departments dep
  WHERE emp.department_id = dep.department_id 
  GROUP BY dep.department_id
  ORDER BY dep.department_id ) depts
WHERE emp.department_id = depts.department_id
      AND depts.max = emp.salary;